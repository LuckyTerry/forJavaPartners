# 腾讯java社招面经

作者：小朋友
链接：https://www.nowcoder.com/discuss/397340?type=2&order=3&pos=3&page=1
来源：牛客网

一面

1.项目
2.mysq|两种存储弓擎的区别
3.如果由大量的增删操作,那么应该选择哪个存储引擎，为什么?
4.redis分布式锁的理解?
5.如果redis作为分布式锁的时候,主节点挂掉了,但是数据还没有同步到从节点,这种情况怎么办?
6.hashmap理解。
7.一个屋子有100栈灯,序号分别是1-100,有打开或关闭两种状态,然后有100个人,序号分别是1-100 ,然后每个人都会进到屋子里面,且每个人都会把自己序号倍数的等执行-次操作(打开或关闭) ,问最终会有几盏灯打开?
8.tp四次挥手过程?为什么等待2MSL。
9.拥塞控制的算法有哪几种?慢开始前期是指数型增长还是线性增长?
10.排序算法你知道那些?快速排序平均时间复杂度和最差时间复杂度。parition过程中最差情况是什么样的,描述一下。
11.一个无序数组,求topk.
12.12306网站设计架构。
13.分库分表是以什么维度来划分的?划分的算法是怎样的,会不会出现数据分配不均衡的情况。
14.myisam和innodb支持锁的粒度是怎样的?
15.解决缓存击穿的方式有哪几种?加锁的时候什么时候选择本地锁,什么时候选择分布式锁?
16.谈谈对面向对象的理解,谈谈对多态的理解。

二面

1.项目
2.一个排序数组,可能有重复元素，要求返回不重复元素个数,并且数组前几位去重。例如1,2,2,3,3,4--》要求前四位是1,2,3,4后面无所谓,返回4.
- 用一个Hash结构

4.一个台阶每次最多能走一个,或走两个,问有多少中走法。
- 动态规划，dp[i] = dp[i-1]+dp[i-2]，其中dp[0]=1,dp[1]=1
5.52张扑克牌，去掉大小王,问我三次摸到同-花色的概率。
- 1*(12/51)*(11/50)
6.一个电商系统,有id ,商品名称字段,问你架构怎么设计,会涉及到模糊查询商品。双写过程会有分布务问题，如何解决。如果采用最终一致性的思想 ,那么并发请求来了好几个发现数据不一致怎么办 ?
- 商品数量大，通过canal将数据异构到es中，在es中查询到id列表，再回mysql中取数据。
- 使用redis的List，对同一个商品的修改操作串行消费。
7.对于一个抢红包的需求, 要求每个用户每分钟最多不能超过5次,问你怎么解决这个问题? [Redis 实现限流的三种方式](https://blog.csdn.net/lmx125254/article/details/90700118/)
- 单击级别的限流，比如guava
- 使用redis限流：
    - setnx，keyValue结构，设置过期时间为1分钟
    - 使用zset，timestamp为score，使用rangeByScore可以实现滑动窗口的限流，比setnx要好
    - 使用list的leftpop，实现令牌桶，另外需要一个定时任务，往里面添加令牌桶，推荐这个吧。
8.订单号不能重复,你怎么设计生成订单号?
- redis的incr，snowflake，百度uid，美团leaf。取决于 订单号是否需要连续，而选择
9.分布式锁如何设计?
- redis实现，setnx，redisson的lua脚本实现
- zookeeper实现，临时顺序节点
10.网络io模型?
- 同步：阻塞、非阻塞、多路复用、信号驱动
- 异步
11.搜索引擎。
- es，倒排索引讲一讲
12.java的虚引|用是什么用的?
- 在这个对象被回收时能收到一个系统通知
13.设计一个登录态系统。 如何保证密码加传输。如果你想服务器请求非对称加密的公钥时,请求被拦截篡改你怎么办?
- 需要在外面包一个数字签名，其实就是证书的样子。有CA公司颁发证书，客户端使用CA公司的公钥解签，得到归属者的公钥。而不是直接向服务端要公钥。
14.数据库主从复制时如何做的?但是如果突然挂掉了,如何保证挂掉那段时间的数据?
- 一个io线程读取master的binlog到relaylog中，一个sql线程重新执行relaylog中的指令。
- 可以开启半同步复制，要求至少有一个slave写入了数据才返回客户端写入成功，性能就介于同步复制和异步复制之间

三面

1.项目
2.作为调用方和被调用放如何对避免服务雪崩?
- 作为服务调用方：超时、降级、熔断、资源隔离
- 作为服务被调用方：请求限流、异步处理、多使用缓存
3.rpc接口的超时时间时如何设置得?
- feign：2秒和5秒
- hystrix：5秒
- ribbon：2秒和5秒
4.跳跃表的思想时怎样的?哪里有用到跳跃表? [跳跃表的分析与实现](https://blog.csdn.net/qq910894904/article/details/37883953)
- 用空间换时间，它是由数据链表和多级的索引链表构成，“跳跃”二字体现在上一级索引往下一级索引跳跃
- redis里面zset有序集合就使用了跳表，原因作者也说了，实现起来简单，性能还很好。
- 跳表空间复杂度O(n)，时间复杂度O(lgn)，高度可以略低O(lgn)
5.服务容灾是如何做的?
- 跟上面第2题答案一样
- 集群部署、异地部署 等
6.你们工作中采用的微服务是如何部署的?
- jenkins+docker+k8s
7.平时出现问题是怎样排查的?
- 来自于客户的问题：分析用户描述，决定是看日志、看链路监控、还是看服务健康状态 等
    - 错误明显就直接定位到相关服务，不明显则从网关开始查找，然后根据traceId全局搜索日志。
    - 链路的话，看最近失败率高的接口有哪些，是否造成了所述的问题。
    - 服务出现oom等，则dump日志分析，并同时伸缩新的实例
- 来自于监控的问题：一般比较明确，如OOM，mysql锁超时，连不上redis 等，具体去分析就行
